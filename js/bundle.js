!function(t){function a(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}var e={};return a.m=t,a.c=e,a.p="",a(0)}([function(t,a,e){var n=e(1);jQuery(document).ready(function(t){n()})},function(t,a){function e(){function t(t){return{name:t,color:p,countries:[],pdata:null,subpackages:{}}}function a(){_.each(l,function(a,n){var o=d[a]=t(a);g(o).done(function(){_.each(o.pdata,function(t,a){-1===_.indexOf(o.countries,t.country)&&o.countries.push(t.country)}),o.name.localeCompare("targetedthreats")||(e(),u=o,r(u,u.color),$("#initial-dataset").addClass("active"))})})}function e(){var t=d.targetedthreats,a=null;t.targets=[],_.each(t.pdata,function(a,e){-1===_.indexOf(t.targets,a.target)&&t.targets.push(a.target)}),_.map(t.targets,function(e){a=t.subpackages[e]=n(e,t.pdata,{target:e}),a.color=p,_.each(a.pdata,function(t,e){-1===_.indexOf(a.countries,t.country)&&a.countries.push(t.country)})})}function n(a,e,n){var r=t(a);return r.pdata=_.filter(e,n),r}function r(t,a){var e={},n=$("#map").vectorMap("get","mapObject");_.each(t.countries,function(t){e[t]=a}),n.series.regions[0].setValues(e)}var o="data-",l=["encryptionlaws","resellers","targetedthreats","vendors"],s={},c={},i="",d={},u=null,f="#d3d3d3",p="#18bc9c",h="#8CDECE",g=function(t){var a=$.ajax({url:url_api+t.name,crossDomain:!0,dataType:"jsonp",jsonp:"callback"});return a.done(function(a){t.pdata=a.result}),a.error(function(){t.loadError=!0}),a.always(function(){}),a},m=function(t,a){var e=_.template($("#view-"+a).html()),n="";_.each(d[a].pdata,function(a,r){if(a.country===t){var o=e(a);n+=o}}),n?$("#"+a).html("<p>&nbsp;</p><ul>"+n+"</ul>"):$("#"+a).html("<h4>No "+a+" data found</h4>")},v=function(t){var a=$("#modal").find("a[href=#"+t+"]");0===a.length&&(t="targetedthreats",a=$("#modal").find("a[href=#"+t+"]")),m(i,t),a.tab("show")},k=function(t){i=t;var a=$("#map").vectorMap("get","mapObject");$("#modal").modal(),$("#modal").find(".modal-title").html("Results for: "+a.getRegionName(t)),v(u.name)},y=function(t){var a="",e=_.template($("#view-datapackages").html());_.each(t.result,function(t,n){a+=e(t)}),$("#datapackages").html(a)},b=function(t){var a=_.findWhere(s,{data_package:t}),e=d[t.replace(o,"")].pdata;if(e){$("#datapackages-details").hide(),$("#datapackages").hide(),$("#datapackages-title").find("h1").html("Dataset: "+a.name),$("#datapackages-title").find("p").html(a.description),$("#show-datasets-toc").removeClass("hidden"),$("#datatable").show();var n=_.keys(e[0]),r=[];_.each(n,function(t){r.push({title:t})});var l=[];_.each(e,function(t,a){l.push(_.values(t))}),c=$("#datatable").DataTable({data:l,columns:r})}},w=function(){$.ajax({url:url_api,crossDomain:!0,dataType:"jsonp",jsonp:"callback",success:function(t){y(t),s=t.result}})};$(document).on("click","a.show-dataset",function(t){t.preventDefault(),b($(this).attr("href").replace("#",""))}),$(document).on("click","#show-datasets-toc",function(t){t.preventDefault(),$(this).addClass("hidden"),c.destroy(),$("#datatable").html(""),$("#datapackages-title").find("h1").html("Our Datasets"),$("#datapackages-title").find("p").html(""),$("#datapackages-details").show(),$("#datapackages").show()}),$(document).ready(function(){($("#map").length||$("#datapackages").length)&&a(),$("#datapackages").length&&w(),$("#map").length&&$("#map").vectorMap({map:"world_mill",backgroundColor:"#ffffff",markersSelectable:!0,markers:{BH:{latLng:[26.02,50.55],name:"Bahrain"}},series:{regions:[{attribute:"fill"}]},regionStyle:{initial:{fill:f,"fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":.8,cursor:"pointer"},selected:{fill:"yellow"},selectedHover:{fill:"yellow"}},markerStyle:{initial:{fill:f,stroke:"none"},selected:{fill:"yellow"}},onRegionClick:function(t,a){k(a)},onMarkerClick:function(t,a){k(a)}}),$("#country-tabs a").click(function(t){var a=$(this).attr("href").replace("#","");t.preventDefault(),v(a)}),$("[class='target-selector'] > a").click(function(t){t.preventDefault(),console.log(this),$(this).tab("show"),r(u,f),r(d.targetedthreats,h);var a=$(this).attr("href").replace("#","");u=d.targetedthreats.subpackages[a],r(u,u.color)}),$("[class='dataset-selector'] > a").click(function(t){t.preventDefault(),console.log(this),$(this).tab("show"),$(".target-selector").removeClass("active"),r(d.targetedthreats,f),r(u,f);var a=$(this).attr("href").replace("#","");u=d[a],r(u,u.color),$(this).is("#tt-toggle")?$("#target-selections>ul").removeClass("hide"):$("#target-selections>ul").addClass("hide")})})}t.exports=e}]);