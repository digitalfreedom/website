!function(t){function a(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}var e={};return a.m=t,a.c=e,a.p="",a(0)}([function(t,a,e){var n=e(1);jQuery(document).ready(function(t){n()})},function(t,a){function e(){function t(t){return{name:t,color:f,countries:[],pdata:null,subpackages:{}}}function a(){_.each(l,function(a,n){var r=d[a]=t(a);m(r).done(function(){_.each(r.pdata,function(t,a){-1===_.indexOf(r.countries,t.country)&&r.countries.push(t.country)}),r.name.localeCompare("targetedthreats")||(e(),u=r,o(u,u.color),$("#initial-dataset").addClass("active"))})})}function e(){var t=d.targetedthreats,a=null;t.targets=[],_.each(t.pdata,function(a,e){-1===_.indexOf(t.targets,a.target)&&t.targets.push(a.target)}),_.map(t.targets,function(e){a=t.subpackages[e]=n(e,t.pdata,{target:e}),a.color=f,_.each(a.pdata,function(t,e){-1===_.indexOf(a.countries,t.country)&&a.countries.push(t.country)})})}function n(a,e,n){var o=t(a);return o.pdata=_.filter(e,n),o}function o(t,a){var e={},n=$("#map").vectorMap("get","mapObject");_.each(t.countries,function(t){e[t]=a}),n.series.regions[0].setValues(e)}var r="data-",l=["encryptionlaws","resellers","targetedthreats","vendors"],s={},c={},i="",d={},u=null,p="#d3d3d3",f="#18bc9c",h="#8CDECE",m=function(t){var a=$.ajax({url:url_api+t.name,crossDomain:!0,dataType:"jsonp",jsonp:"callback"});return a.done(function(a){t.pdata=a.result}),a.error(function(){t.loadError=!0}),a.always(function(){}),a},g=function(t,a){var e=_.template($("#view-"+a).html()),n="";_.each(d[a].pdata,function(a,o){if(a.country===t){var r=e(a);n+=r}}),n?$("#"+a).html("<p>&nbsp;</p><ul>"+n+"</ul>"):$("#"+a).html("<h4>No "+a+" data found</h4>")},v=function(t){var a="",e=_.template($("#view-datapackages").html());_.each(t.result,function(t,n){a+=e(t)}),$("#datapackages").html(a)},k=function(t){var a=_.findWhere(s,{data_package:t}),e=d[t.replace(r,"")].pdata;if(e){$("#datapackages-details").hide(),$("#datapackages").hide(),$("#datapackages-title").find("h1").html("Dataset: "+a.name),$("#datapackages-title").find("p").html(a.description),$("#show-datasets-toc").removeClass("hidden"),$("#datatable").show();var n=_.keys(e[0]),o=[];_.each(n,function(t){o.push({title:t})});var l=[];_.each(e,function(t,a){l.push(_.values(t))}),c=$("#datatable").DataTable({data:l,columns:o})}},y=function(){$.ajax({url:url_api,crossDomain:!0,dataType:"jsonp",jsonp:"callback",success:function(t){v(t),s=t.result}})};$(document).on("click","a.show-dataset",function(t){t.preventDefault(),k($(this).attr("href").replace("#",""))}),$(document).on("click","#show-datasets-toc",function(t){t.preventDefault(),$(this).addClass("hidden"),c.destroy(),$("#datatable").html(""),$("#datapackages-title").find("h1").html("Our Datasets"),$("#datapackages-title").find("p").html(""),$("#datapackages-details").show(),$("#datapackages").show()}),$(document).ready(function(){($("#map").length||$("#datapackages").length)&&a(),$("#datapackages").length&&y(),$("#map").length&&$("#map").vectorMap({map:"world_mill",backgroundColor:"#ffffff",markersSelectable:!0,markers:{BH:{latLng:[26.02,50.55],name:"Bahrain"}},series:{regions:[{attribute:"fill"}]},regionStyle:{initial:{fill:p,"fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":.8,cursor:"pointer"},selected:{fill:"yellow"},selectedHover:{fill:"yellow"}},markerStyle:{initial:{fill:p,stroke:"none"},selected:{fill:"yellow"}},onRegionClick:function(t,a){i=a;$("#map").vectorMap("get","mapObject");$("#modal").modal(),$("#modal").find(".modal-title").html("Results for: "+a)},onMarkerClick:function(t,a){i=a;$("#map").vectorMap("get","mapObject");$("#modal").modal(),$("#modal").find(".modal-title").html("Results for: "+a)}}),$("#country-tabs a").click(function(t){t.preventDefault(),g(i,$(this).attr("href").replace("#","")),$(this).tab("show")}),$("[class='target-selector'] > a").click(function(t){t.preventDefault(),console.log(this),$(this).tab("show"),o(u,p),o(d.targetedthreats,h);var a=$(this).attr("href").replace("#","");u=d.targetedthreats.subpackages[a],o(u,u.color)}),$("[class='dataset-selector'] > a").click(function(t){t.preventDefault(),console.log(this),$(this).tab("show"),$(".target-selector").removeClass("active"),o(d.targetedthreats,p),o(u,p);var a=$(this).attr("href").replace("#","");u=d[a],o(u,u.color),$(this).is("#tt-toggle")?$("#target-selections>ul").removeClass("hide"):$("#target-selections>ul").addClass("hide")})})}t.exports=e}]);